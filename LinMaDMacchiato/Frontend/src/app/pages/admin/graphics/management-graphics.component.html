<div class="max-w-screen-xl mx-auto px-4">
    <!-- Indicadores rápidos -->
    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
        <!-- Tarjeta Gasto de clientes esta semana -->
        <div class="bg-white border border-gray-200 rounded-xl p-6 shadow transition hover:shadow-lg">
          <div class="mb-4 flex items-center space-x-3">
            <div class="flex items-center justify-center w-12 h-12 rounded-full bg-gray-100 text-gray-700">
                <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAACXBIWXMAAAsTAAALEwEAmpwYAAAEqElEQVR4nO1aS4gcVRStGD9R8BM0JmrS71VPE0GELFy5kGz8QszMpO/t+URIIKAohIlmEUVwFrrROGpQZ6h7ux3UjWTlJ36ycyOYKFlEkkwmATHOLMQYRQn5jM7IreruSU9/7LqvqjNILjxourvue+fd8+7vleddkf+pZEYHl5tioccQ7LYEnxvCCctwxhBekCGfLeOx6Df5T77bjHff4i0Gye159LoMwWZDuN8S/m0Z52INeYbwS8M4KLq8TsvqEbzeED5nCaZjL775mDIEO8z4lmUdAWGC/GOW4WSCAGqGITxhqfBIagDE9IZgT1oAGgD6QCyfKAif+1daxu87BcJWwDAczI723p4ICDPWZ0NzdxiErYLBSVmDE4hcCVdEbvTygLDVASfNOK7SWWJ8y7Ik6FTVR/inK81yGhdtGcaS2M2kgNjIAbytcLHOdPjHMvw4DwR+UAVNXjCK+YfbAiEuzyVOGMavo/SjPrDJd4ZwwDAedtA/2RbFwoit3S3CXd6ctyTUU8T7DePzlvHNcAQ4tCbo65LfZCGWoKSeJ8ChliDKE+jSDsLR0KJjeJdl/KbJf2YlqHp7cak3PHyVJJBKq/zc0iqSACp36axkv7JAS3iojYW8LPPZ4iZjGC6qwBAOtKLVfuUOfSLP+4wPtWc9OHfn+z23hnMyfqzcvC8aW2N0cLnWqxjG18qLejYGFQvRM7BTOedM7sPNN9Vbo1joUe6MKH0xpArhKzGeG8mUNmW1QCzjnM+Fx+uAWMLXXQOVIdyq1eHChBqxhPvUSgmPiI47gg03pFmr2Hogn9WiiPg96aLUp/wG0ZMNMGMYvuoIEMKJOiCW8LTj7vxiS4V1FX0+9a0Nz0zojiVdScMi8Gu9RcJOh7Pys5bxpTCmLOywEPYaBpJgliC1zqcFpApI+GsCeKaLMVcz0Zy3RBI/Q3ggFSDWkVotB8G0IfzIJ4RqahGlKG8kTy2G46kBqRlwRgJnxTqOjuFYsu5XZSXcFTmF/ANqixB82uCMwG7lgn7zi4A+4xPxaIF/hFmwnBmCczog+GoDi+S7lcouCN9lUXEz2Rz1ro5ojT+5xK4akYayNmnseq9vTagjpieqJH2G8a/YG8hwsWHSGCnUHjx4Sp7PEG6LYcnv5JlssXCvak7CfQ1BlHdmUEmvA2GJO7z+6nY2Q1JwPyg8KHNaxndVcwbQ37rUZZxSKWZ8upI4Sjbc9LwQTFe4bQNcr6kQDcGpe/bitU2BRDyHHUogM0Kt+TOHq8pUG5Hmg2F4QSrI+4InrymD2GgJf9fRCra3BHFJy+aESztI3HGj5nM2wJulGAqbDoSzShpPtN1xlPsJLZAFY+oSS59y1kc4WzlbbYtleCcJMPP63HUZxrc81cUOw8HFAsQwfvufB7yZrA0Gblss1wo+96/0nC96HMtgN0vAcWnkeUmIeKAkaKahU66EK7xULkOVblMBIkj17j0sU1OkmiGciO1itRKmMgEOJdpIkDhDsP2yvAER0Q0HwvdLGGcU9JmRLFYSQLVrTVqkNpD0Q9qY0kGJXqDB09WXaqS5QXBUylOp7CRxvLu48cbEF3JFvMUh/wLoAPE6pj26BwAAAABJRU5ErkJggg==" alt="us-dollar-circled--v1" width="25" height="24">
            </div>
            <div>
              <p class="text-sm text-gray-500">Gasto de clientes esta semana</p>
              <h2 class="text-3xl font-bold text-neutral-800">${{ totalGastadoSemana }}</h2>
            </div>
          </div>
          <div class="flex items-center gap-1.5">
            <span class="flex items-center gap-1 rounded-full bg-success-50 px-2 py-0.5 text-theme-xs font-medium text-success-600 dark:bg-success-500/15 dark:text-success-500">
              {{ calculatePercentage(totalGastadoSemana, previousTotalGastadoSemana) }}
            </span>
            <span class="text-theme-xs text-gray-500 dark:text-gray-400">Vs semana pasada</span>
          </div>
        </div>
      
        <!-- Tarjeta Reservas completadas vs canceladas -->
        <div class="bg-white border border-gray-200 rounded-xl p-6 shadow transition hover:shadow-lg">
          <div class="mb-4 flex items-center space-x-3">
            <div class="flex items-center justify-center w-12 h-12 rounded-full bg-gray-100 text-gray-700">
                <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB3ElEQVR4nO2WPyzEUBzHX+738ydEYmA1MwqTfzMxsjKzWNgkbhJ9r5eI2K3kVoMgIbjk2qdBYjPYxCpnMaDS9hzneq+thPYlv0/yTYe+Jr9vv+/1W8YIgiAIgiCIf8UWcCEFulmUzfE4gRF8TntgqZBjsL54Rjjcpj2sVApmYhmRAvczbsSIubVgO/1hUaWTuImsZGBYV6GKm2e5pgZuTNbpXS8NmM3AsK5KZaN1oHkSPDfnby2Ow2kPKiNkidy8wggeelenwHrSHlRGyDvHoSauN1m35Pjq5FlH9ZxUMm2EgxVqxDJh2lvgFFr7degSm+PL3RZrC/lSgVGNbFKPLkHXKrQMNRixOZSqThcSdYmBI+wPuBQ4GpmKwMW6h07zrN2Lyl/AYSNJlzgGjv2FEYvjeLQR2Kl7yDZx4tve29WlS2wOt/VGBK5+LYCyLl1iC3wrcdZVMyI5HtQWcHzUpUukZ8bECd9EscjAFvj0bWu969IlMph3OUij0DL486YuXSKD7bX3edCXGm/q0yWSw32QiMBiSFzJuiRlXa2zXu+L9RDiMlGXpC4Tprxfk/OQRLTpEum/eFxTtqsOXSID7SuN6NIlstp96lQEHmXfCJxFGiEIgiAIgiDYb/kAAPsGlypuUnkAAAAASUVORK5CYII=" alt="reservation" width="25" height="24">
            </div>
            <div>
              <p class="text-sm text-gray-500">Reservas completadas vs canceladas</p>
              <h2 class="text-3xl font-bold text-neutral-800">{{ reservasCompletadas }} / {{ reservasCanceladas }}</h2>
            </div>
          </div>
          <div class="flex items-center gap-1.5">
            <span class="flex items-center gap-1 rounded-full bg-error-50 px-2 py-0.5 text-theme-xs font-medium text-error-600 dark:bg-error-500/15 dark:text-error-500">
              {{ calculatePercentage(reservasCompletadas, previousReservasCompletadas) }}
            </span>
            <span class="text-theme-xs text-gray-500 dark:text-gray-400">Vs mes pasado</span>
          </div>
        </div>
      
        <!-- Tarjeta Clientes nuevos este mes -->
        <div class="bg-white border border-gray-200 rounded-xl p-6 shadow transition hover:shadow-lg">
          <div class="mb-4 flex items-center space-x-3">
            <div class="flex items-center justify-center w-12 h-12 rounded-full bg-gray-100 text-gray-700">
                <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAACXBIWXMAAAsTAAALEwEAmpwYAAAE8klEQVR4nO2ZW2gcZRSAJxU1XqpV7EO9NDX7/xuJUATx8iZeqrZVi0KgEjHOOeuKlWo1XuoF4+1BFBR9ExFBUHz2gvii0Pqg1VKpVEGxscXNZs6ZpDHWVmrNyvlnNpnMzk5nd2Z2q3hgyCY5e87//Zdzzn/Gsv6X/4AM4szZGmijQnpJA3+igfZppN80ck0hf6vsieXW8Su1ngI6NyrkjzTSURl0s0ch7z4uYXTJuUQBb4sbfMMDNKOBPlfIryvg4f7y9JldhSiW+D4FdKQliEgw/lMBv7kKpvs6jFDrUcCvpQZofA4r4E0dw9DAz+UAETxHb1tjtSW5Qih012igv/ME8Z9X84PY/OPJGvinDkDUg8LGXEA08j0dgzBbjCoDwEtzAKHvOgliYIBfyBRC2e5gRrP8sgb6IPn24slLy7UTswMBeiAdBM0p5OfFVn95eqUGdpLD882ZgWigd1NsjwkpYYL2infzZRpoOuH338sQhL9pHYCmNNBTatg9I8rmAPCA1F4JbO3MEmQyIcBhqXqlhlpRrpx6LLuDQ7WTFPKjGplizomTHQjyoYh9L+X5TgX8vkLeWizxNecP7T+lHfur76iepmzaEhkZgf/IEITmQvuWrZxEbIcDhZWVRBzAbVZOopC3h/1ZOYK8EaXXNzLeK6VMGl9iu3MgNm0JOR+Wq2wgZ+xW6NgNdoDWmyswctXLJfRpODR7Z6VDIIWSc8PC4PiVQMj9Sy5KPtCBsB2FNBsdmeiJuo7YzgWkb2S8twHkrqkLAoNzJezKjXFwk3O6NVQ7QQajSu6VDSAluklWSt/pnndRmVZItDPwAWixHfbXNzLemxpEI90fSnQ/yC2x/v+BkeqqAjqqXfsCLJk+dAP9YvGKOZszy+oF4Fvi9MwqII+bB9zr0+p5urzBn7wdVlpRwL+LsWK5ck6cnkbaH9jz+9LqGd/2xPJ68rXSikI+6O3TA8vi9agyv/2Qfk2rJ7Ly3pmzsgOBet+KnkxtrGXfNOb7/iy1MRP7TYki+YGeTpvwEkdK4Gfn/UL8WUosGnk00A6tanQvz8RwlC/bvWKh2qa5ItBDmTooAF8duD+8Zf2bpYCOkr6WRLKoDkerl6/uUPji10oykFGrSahO9jRGolYnQqeZJCkz/NBZCZcOCunrpI4U0FddBbHGaksU8K5wseev1sOJQZAetLotRZvWerNqzsq59b/LPV1qsQTbak8mhWAWooE/9GE+DhaR2p7sj4ehPcVS9cK8tpRudYtJKW7ePkUcfFkZDfyINCf8xsUhv/gcjWpQdBVERJfodi/z0pE02XeRc9u9tV07Ihrd21oGMV80pYRpbR7USOuSf4/Wz3/2nRaBr43TV0A75FzKz+a+aj3adq9rGcS/CJmGgXfb42fiGs+BOupoGCQOQkeft6YT1waIJ1IT1esxhfSLhOJCaepiORPSgCvi5GqpoBXw3nC/KuxU3tP7K/xiMD8p4MdMMw95azAXhfVTgczXY0DfJwm/yqarYkBmg9lf+b+bnoDXN17qT9hslH5qECOm+cAbpIMv11m/qyJvbPdqpHfMlTn0sjPsVCKeQv5ZVtUMFORMiI77uMBIIg6uSFg/G5A25FhOlbyEDbVtTXCwaW27NnORhbLFXRNMrot1aJ2sgIlaSF82h6j1eOBdBOlqHslCup7ZrYwkT5B/ALE8v9C2R/jNAAAAAElFTkSuQmCC" alt="budget" width="25" height="24">
            </div>
            <div>
              <p class="text-sm text-gray-500">Clientes nuevos este mes</p>
              <h2 class="text-3xl font-bold text-neutral-800">{{ clientesNuevos }}</h2>
            </div>
          </div>
          <div class="flex items-center gap-1.5">
            <span class="flex items-center gap-1 rounded-full bg-error-50 px-2 py-0.5 text-theme-xs font-medium text-error-600 dark:bg-error-500/15 dark:text-error-500">
              {{ calculatePercentage(clientesNuevos, previousClientesNuevos) }}
            </span>
            <span class="text-theme-xs text-gray-500 dark:text-gray-400">Vs mes pasado</span>
          </div>
        </div>
      </div>
      
      
       
    <!-- Gráficos -->
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
      <div class="bg-white rounded-2xl border border-gray-200 p-6 shadow">
        <div class="flex items-center justify-between mb-4">
          <h3 class="text-lg font-semibold text-gray-800">Categorías más vendidas</h3>
          <span class="text-sm text-gray-400">Distribución porcentual</span>
        </div>
        <div class="flex flex-col xl:flex-row items-start gap-4">
          <div class="relative w-[200px] h-[200px] shrink-0 mr-4">
            <canvas baseChart [data]="categoriasChartData" [type]="'doughnut'" [options]="categoriasChartOptions"></canvas>
          </div>
          <div class="grid grid-cols-2 gap-x-4 gap-y-1 w-full max-w-xl">
            <div *ngFor="let label of categoriasChartData.labels; let i = index" class="flex items-start gap-2">
              <div class="mt-1.5 h-2 w-2 rounded-full" [ngStyle]="{ backgroundColor: getCategoriaColor(i) }"></div>
              <div class="leading-tight">
                <h5 class="font-medium text-gray-800 text-sm">{{ label }}</h5>
                <div class="flex items-center gap-1 text-sm text-gray-500">
                  {{ getCategoriaPorcentaje(i) }}%
                  <div class="w-1 h-1 bg-gray-400 rounded-full"></div>
                  {{ categoriasChartData.datasets[0].data[i] }} productos
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="bg-white rounded-2xl border border-gray-200 p-6 shadow">
        <h3 class="text-lg font-semibold text-gray-800 mb-4">Top Clientes del Mes</h3>
        <div class="overflow-x-auto">
          <table class="min-w-full text-sm text-left">
            <thead class="bg-[#F2E1C2] text-[#4B2E2A] uppercase text-xs">
              <tr>
                <th class="px-4 py-3">Cliente</th>
                <th class="px-4 py-3 text-right">Total Gastado</th>
              </tr>
            </thead>
            <tbody class="divide-y divide-gray-200">
                <tr *ngFor="let cliente of clientesTop">
                    <td class="px-4 py-3">
                      <div class="flex items-center gap-3">
                        <div class="w-10 h-10 rounded-full bg-[#F2E1C2] text-[#4B2E2A] flex items-center justify-center font-bold text-sm">
                          {{ cliente.name.charAt(0) }}{{ cliente.lastName.charAt(0) }}
                        </div>
                        <div>
                          <p class="text-sm font-medium text-gray-800">
                            {{ cliente.name }} {{ cliente.lastName }}
                          </p>
                        </div>
                      </div>
                    </td>
                    <td class="px-4 py-3 text-right font-semibold text-[#8B5E3C]">
                      ${{ cliente.total }}
                    </td>
                </tr>                      
            </tbody>
          </table>
        </div>
        </div>                   
    </div>
  
    <!-- Productos destacados y baja rotación -->
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
        <!-- Top productos más vendidos -->
        <div class="bg-white rounded-2xl border border-gray-200 p-6 shadow">
          <h3 class="text-lg font-semibold text-gray-800 mb-4">Top productos más vendidos</h3>
          <div class="space-y-4">
            <div *ngFor="let p of productosMasVendidos" class="flex items-center justify-between border-b pb-3 last:border-b-0">
              <!-- Imagen o inicial -->
              <div class="flex items-center gap-4">
                <div class="w-10 h-10 rounded-full bg-gray-100 flex items-center justify-center overflow-hidden">
                  <ng-container *ngIf="p.image_url; else inicialTop">
                    <img [src]="p.image_url" alt="{{ p.name }}" class="w-10 h-10 rounded-full object-cover border border-gray-200" />
                  </ng-container>
                  <ng-template #inicialTop>
                    <span class="text-sm font-bold text-gray-700">{{ p.name.charAt(0) }}</span>
                  </ng-template>
                </div>
                <p class="text-gray-700 text-sm font-medium">{{ p.name }}</p>
              </div>
      
              <!-- Barra -->
              <div class="flex w-full max-w-[140px] items-center gap-3">
                <div class="relative block h-2 w-full max-w-[100px] rounded-sm bg-gray-200">
                  <div
                    class="absolute left-0 top-0 h-full rounded-sm bg-[#8B5E3C]"
                    [ngStyle]="{ width: (p.quantity / (productosMasVendidos[0].quantity || 1) * 100) + '%' }"
                  ></div>
                </div>
                <span class="text-sm font-medium text-gray-700">{{ p.quantity }}</span>
              </div>
            </div>
          </div>
        </div>
      
        <!-- Productos con baja rotación -->
        <div class="bg-white rounded-2xl border border-gray-200 p-6 shadow">
          <h3 class="text-lg font-semibold text-gray-800 mb-4">Productos con baja rotación</h3>
          <div class="space-y-4">
            <div *ngFor="let p of productosMenosVendidos" class="flex items-center justify-between border-b pb-3 last:border-b-0">
              <!-- Imagen o inicial -->
              <div class="flex items-center gap-4">
                <div class="w-10 h-10 rounded-full bg-red-50 flex items-center justify-center overflow-hidden">
                  <ng-container *ngIf="p.image_url; else inicialBaja">
                    <img [src]="p.image_url" alt="{{ p.name }}" class="w-10 h-10 rounded-full object-cover border border-gray-200" />
                  </ng-container>
                  <ng-template #inicialBaja>
                    <span class="text-sm font-bold text-red-500">{{ p.name.charAt(0) }}</span>
                  </ng-template>
                </div>
                <p class="text-gray-700 text-sm font-medium">{{ p.name }}</p>
              </div>
      
              <!-- Barra -->
              <div class="flex w-full max-w-[140px] items-center gap-3">
                <div class="relative block h-2 w-full max-w-[100px] rounded-sm bg-red-100">
                  <div
                    class="absolute left-0 top-0 h-full rounded-sm bg-red-500"
                    [ngStyle]="{ width: (p.quantity / (productosMenosVendidos[0].quantity || 1) * 100) + '%' }"
                  ></div>
                </div>
                <span class="text-sm font-semibold text-red-500">{{ p.quantity }}</span>
              </div>
            </div>
          </div>
        </div>
    </div>
      
    <!-- Clientes y Órdenes recientes -->
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
        
        <div class="bg-white rounded-2xl border border-gray-200 p-6 shadow flex flex-col items-start justify-center">
            <!-- Título con punto verde al lado -->
            <div class="flex items-center space-x-4 mb-4">
              <h3 class="text-lg font-semibold text-gray-800">Usuarios Activos</h3>
              <!-- Promedios junto al título -->
              <div class="flex space-x-6">
                <div class="flex flex-col items-center">
                  <p class="text-lg font-semibold text-gray-800">{{ promedioDiario }}</p>
                  <p class="text-sm text-gray-500">Prom. Diario</p>
                </div>
                <div class="h-10 w-px bg-gray-200"></div>
                <div class="flex flex-col items-center">
                  <p class="text-lg font-semibold text-gray-800">{{ promedioSemanal }}</p>
                  <p class="text-sm text-gray-500">Prom. Semanal</p>
                </div>
                <div class="h-10 w-px bg-gray-200"></div>
                <div class="flex flex-col items-center">
                  <p class="text-lg font-semibold text-gray-800">{{ promedioMensual }}</p>
                  <p class="text-sm text-gray-500">Prom. Mensual</p>
                </div>
              </div>
            </div>
            
            <!-- Gráfico de Usuarios Activos (centrado) -->
            <div class="relative w-full">
              <!-- Canvas con gráfico centrado y más grande -->
              <div class="relative w-full h-80"> <!-- Ajuste de altura (h-80) -->
                <canvas baseChart
                        [datasets]="chartData.datasets"
                        [labels]="chartData.labels"
                        [options]="chartOptions"
                        [type]="'line'">
                </canvas>
              </div>
            </div>
          </div>          
  
      <div class="overflow-hidden rounded-2xl border border-gray-200 bg-white px-4 pt-4 pb-3 sm:px-6">
        <div class="flex flex-col gap-2 mb-4 sm:flex-row sm:items-center sm:justify-between">
          <h3 class="text-lg font-semibold text-gray-800">Órdenes recientes</h3>
          <div class="flex items-center gap-3">
            <!-- <button class="text-sm inline-flex items-center gap-2 rounded-lg border border-gray-300 bg-white px-4 py-2 font-medium text-gray-700 hover:bg-gray-50 hover:text-gray-800">
              Filtrar
            </button>
            <button class="text-sm inline-flex items-center gap-2 rounded-lg border border-gray-300 bg-white px-4 py-2 font-medium text-gray-700 hover:bg-gray-50 hover:text-gray-800">
              Ver todas
            </button> -->
          </div>
        </div>
      
        <div class="max-w-full overflow-x-auto">
          <table class="min-w-full">
            <thead class="border-y border-gray-100 bg-[#F2E1C2] text-[#4B2E2A] text-xs uppercase">
              <tr>
                <th class="px-6 py-3 text-left">ID</th>
                <th class="px-6 py-3 text-left">Total</th>
                <th class="px-6 py-3 text-left">Entrega</th>
                <th class="px-6 py-3 text-left">Fecha</th>
              </tr>
            </thead>
            <tbody class="divide-y divide-gray-100">
              <tr *ngFor="let orden of ordenesRecientes">
                <td class="px-6 py-4 text-sm font-semibold text-gray-800">{{ orden.id }}</td>
                <td class="px-6 py-4 text-sm text-gray-600">${{ orden.total }}</td>
                <td class="px-6 py-4">
                  <span 
                    [ngClass]="{
                      'bg-green-100 text-green-700': orden.tipoEntrega === 'tienda',
                      'bg-yellow-100 text-yellow-700': orden.tipoEntrega === 'delivery',
                      'bg-red-100 text-red-700': orden.tipoEntrega === 'cancelado'
                    }"
                    class="text-xs font-semibold px-2 py-1 rounded-full capitalize"
                  >
                    {{ orden.tipoEntrega }}
                  </span>
                </td>
                <td class="px-6 py-4 text-sm text-gray-600">{{ orden.createdAt }}</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>      
    </div>
</div>
  